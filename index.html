<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>WebHosting</title>
    <link rel="stylesheet" href="./src/style.css">
    <script type="text/javascript" src="./src/sticky.js"></script>
</head>
<body>
    <h1>Image Cropper</h1>
    <label>
        <input id="file" type="file">
    </label>
    <section id="ImageCropper">
        <img id="preview" src=""/>
        <canvas id="canvas" width="500" height="500"></canvas>
    </section>
    <h1>Sticky</h1>
    <section id="wrap"><div class="red"></div><div class="blue"></div><div class="green"></div></section>

    <script>
        window.addEventListener('load', function () {
            new Sticky(document.getElementById('wrap'));
        })
    </script>

    <script>
        var reader = new FileReader();
        var fileInput = document.getElementById('file');
        var preview = document.getElementById('preview');
        var cvs = document.getElementById('canvas');
        var ctx = cvs.getContext('2d');
        var ImageCropper = document.getElementById('ImageCropper');

        fileInput.addEventListener('change', function() {
            reader.readAsDataURL(fileInput.files[0]);
        });
        var w = 0,
            h = 0,
            r = 0,
            t = 0,
            l = 0,
            func = function() {
                t = 250 - h / 2;
                l = 250 - w / 2;
                preview.style.top = t + 'px';
                preview.style.left = l + 'px';
                preview.style.width = w + 'px';
                preview.style.height = h + 'px';
            }
        ;
        reader.addEventListener('load', function() {
            preview.src = reader.result;
            preview.addEventListener('load', function() {
                w = preview.width, h = preview.height, r = w / h;
                func();
            });
        });
        ImageCropper.addEventListener('wheel', function(e) {
            e.preventDefault();
            w -= e.deltaY * r;
            h -= e.deltaY;
            // ctx.clearRect(0, 0, 500, 500);
            // ctx.drawImage(preview, 250 - w / 2, 250 - h / 2, w, h);
            func();
        });


        function mouseMove(e) {
            console.log(e);
            e.preventDefault();
        }
        function mouseUp() {
            ImageCropper.removeEventListener('mousemove', mouseMove);
            document.body.removeEventListener('mouseup', mouseUp);
        }
        cvs.addEventListener('mousedown', function() {
            ImageCropper.addEventListener('mousemove', mouseMove);
            document.body.addEventListener('mouseup', mouseUp);
        });
    </script>
</body>
</html>